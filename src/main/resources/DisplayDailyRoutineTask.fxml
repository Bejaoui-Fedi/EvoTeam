<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.effect.GaussianBlur?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="tn.esprit.controllers.DisplayDailyRoutineTask"
           prefWidth="1150" prefHeight="800"
           stylesheets="@styles.css">

    <!-- ðŸŒ¿ Background nature apaisant -->
    <ImageView fitWidth="1150" fitHeight="800" preserveRatio="false" styleClass="nature-background">
        <image>
            <Image url="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?w=1600&amp;q=80"
                   backgroundLoading="true"/>
        </image>
        <effect>
            <GaussianBlur radius="5"/>
        </effect>
    </ImageView>

    <!-- ðŸŒ¿ Overlay vert pistache -->
    <Region styleClass="overlay"/>

    <!-- Contenu principal -->
    <BorderPane style="-fx-background-color: transparent; -fx-padding: 20;">

        <!-- Header -->
        <top>
            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 20 0 20 0;">
                <HBox alignment="CENTER" spacing="15">
                    <Label text="âœ…" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                    <Label text="TÃ¢ches de routine" styleClass="header-label" style="-fx-font-size: 32;"/>
                    <Label text="ðŸŒ¿" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                </HBox>
            </VBox>
        </top>

        <!-- Centre -->
        <center>
            <VBox spacing="15" styleClass="card" style="-fx-padding: 20; -fx-background-color: rgba(255,255,255,0.7);"
                  VBox.vgrow="ALWAYS">

                <!-- ðŸ” BARRE DE RECHERCHE AVANCÃ‰E -->
                <VBox spacing="10" style="-fx-padding: 0 0 10 0;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="ðŸ”" style="-fx-font-size: 20;"/>
                        <TextField fx:id="searchField"
                                   promptText="Rechercher par utilisateur, titre, statut..."
                                   HBox.hgrow="ALWAYS"
                                   prefHeight="40"
                                   styleClass="search-field"/>
                        <Button fx:id="searchBtn"
                                text="Rechercher"
                                styleClass="button-primary"/>
                        <Button fx:id="clearSearchBtn"
                                text="âœ–"
                                styleClass="button-secondary"
                                visible="false" managed="false"
                                onAction="#clearSearch"/>
                    </HBox>

                    <!-- Suggestions en temps rÃ©el -->
                    <ListView fx:id="suggestionsListView"
                              visible="false" managed="false"
                              prefHeight="150"
                              style="-fx-background-color: white; -fx-border-color: #E2E2E2; -fx-border-radius: 5;"/>
                </VBox>

                <!-- Barre d'actions -->
                <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
                    <Button text="âž• Nouvelle tÃ¢che"
                            onAction="#goToAdd"
                            styleClass="button-primary"/>

                    <Button text="ðŸ”„ RafraÃ®chir"
                            onAction="#refresh"
                            styleClass="button-secondary"/>

                    <Region HBox.hgrow="ALWAYS"/>

                    <!-- Filtres de recherche rapide -->
                    <HBox spacing="5" alignment="CENTER">
                        <ToggleButton fx:id="filterAllBtn" text="Tous"
                                      styleClass="filter-chip" selected="true"/>
                        <ToggleButton fx:id="filterTitleBtn" text="ðŸ“ Titre"
                                      styleClass="filter-chip"/>
                        <ToggleButton fx:id="filterUserBtn" text="ðŸ‘¤ Utilisateur"
                                      styleClass="filter-chip"/>
                        <ToggleButton fx:id="filterStatusBtn" text="âœ… Statut"
                                      styleClass="filter-chip"/>
                    </HBox>

                    <!-- Filtres existants -->
                    <fx:define>
                        <ToggleGroup fx:id="filterGroup"/>
                    </fx:define>

                    <HBox spacing="10" alignment="CENTER" style="-fx-background-color: rgba(255,255,255,0.5); -fx-padding: 5 10; -fx-background-radius: 25;">
                        <Label text="Filtrer:" style="-fx-font-size: 13; -fx-font-weight: bold; -fx-text-fill: #3A7D6B;"/>
                        <RadioButton text="Toutes" toggleGroup="$filterGroup" selected="true"
                                     style="-fx-text-fill: black; -fx-font-size: 13;"/>
                        <RadioButton text="Ã€ faire" toggleGroup="$filterGroup"
                                     style="-fx-text-fill: black; -fx-font-size: 13;"/>
                        <RadioButton text="ComplÃ©tÃ©es" toggleGroup="$filterGroup"
                                     style="-fx-text-fill: black; -fx-font-size: 13;"/>
                    </HBox>
                </HBox>

                <!-- Compteur -->
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label fx:id="lblCount" text="0 tÃ¢che(s)"
                           styleClass="subheader-label" style="-fx-font-size: 16; -fx-font-weight: bold;"/>
                </HBox>

                <!-- Cards Container -->
                <ScrollPane fitToWidth="true" prefHeight="550"
                            style="-fx-background-color: transparent; -fx-border-color: transparent;">
                    <content>
                        <FlowPane fx:id="cardsContainer"
                                  hgap="20" vgap="20"
                                  prefWrapLength="1000"
                                  styleClass="flow-pane"
                                  style="-fx-padding: 10;" />
                    </content>
                </ScrollPane>

            </VBox>
        </center>

        <!-- Footer -->
        <bottom>
            <HBox alignment="CENTER" style="-fx-padding: 20 0 10 0;">
                <VBox alignment="CENTER" spacing="5">
                    <Label text="ðŸŒ¿ Une tÃ¢che Ã  la fois - Restez organisÃ© âœ…"
                           style="-fx-font-size: 14; -fx-text-fill: #3A7D6B;"/>
                    <Label text="(c) 2026 EVOLIA - Gestion des tÃ¢ches"
                           style="-fx-font-size: 12; -fx-text-fill: #6F9A8D;"/>
                </VBox>
            </HBox>
        </bottom>

    </BorderPane>
</StackPane>