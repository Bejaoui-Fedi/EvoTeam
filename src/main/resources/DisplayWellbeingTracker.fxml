<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.effect.GaussianBlur?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="tn.esprit.controllers.DisplayWellbeingTracker"
           prefWidth="1150"
           prefHeight="1200"
           stylesheets="@styles.css">

    <!-- ðŸŒ¿ Background nature apaisant -->
    <ImageView fitWidth="1150" fitHeight="800" preserveRatio="false" styleClass="nature-background">
        <image>
            <Image url="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?w=1600&amp;q=80"
                   backgroundLoading="true"/>
        </image>
        <effect>
            <GaussianBlur radius="5"/>
        </effect>
    </ImageView>

    <!-- ðŸŒ¿ Overlay vert pistache -->
    <Region styleClass="overlay"/>

    <!-- Contenu principal -->
    <BorderPane style="-fx-background-color: transparent; -fx-padding: 20;">

        <!-- Header avec Dashboard -->
        <top>
            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 20 0 20 0;">
                <HBox alignment="CENTER" spacing="15">
                    <Label text="âœ…" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                    <Label text="Suivi Bien-Ãªtre" styleClass="header-label" style="-fx-font-size: 32;"/>
                    <Label text="ðŸŒ¿" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                </HBox>
                <Label text="Suivez votre humeur, stress et sommeil au quotidien" styleClass="subheader-label"/>
            </VBox>
        </top>

        <!-- Centre -->
        <center>
            <VBox spacing="15" styleClass="card" style="-fx-padding: 20; -fx-background-color: rgba(255,255,255,0.7);"
                  VBox.vgrow="ALWAYS">

                <!-- Weather Box -->
                <VBox fx:id="weatherBox" spacing="5" style="-fx-padding: 10;">
                    <!-- Weather will be loaded here dynamically -->
                </VBox>

                <!-- ðŸ” BARRE DE RECHERCHE AVANCÃ‰E -->
                <VBox spacing="10" style="-fx-padding: 0 0 10 0;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="ðŸ”" style="-fx-font-size: 20;"/>
                        <TextField fx:id="searchField"
                                   promptText="Rechercher par utilisateur, humeur, stress, Ã©nergie, sommeil..."
                                   HBox.hgrow="ALWAYS"
                                   prefHeight="40"
                                   styleClass="search-field"/>
                        <Button fx:id="searchBtn"
                                text="Rechercher"
                                styleClass="button-primary"/>
                        <Button fx:id="clearSearchBtn"
                                text="âœ–"
                                styleClass="button-secondary"
                                visible="false" managed="false"
                                onAction="#clearSearch"/>
                    </HBox>

                    <!-- Suggestions en temps rÃ©el -->
                    <ListView fx:id="suggestionsListView"
                              visible="false" managed="false"
                              prefHeight="150"
                              style="-fx-background-color: white; -fx-border-color: #E2E2E2; -fx-border-radius: 5;"/>
                </VBox>

                <!-- Barre d'actions -->
                <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
                    <Button text="âž• Nouveau suivi"
                            onAction="#goToAdd"
                            styleClass="button-primary"/>

                    <Button text="ðŸ”„ RafraÃ®chir"
                            onAction="#refresh"
                            styleClass="button-secondary"/>

                    <Region HBox.hgrow="ALWAYS"/>

                    <!-- Filtres de recherche rapide -->
                    <HBox spacing="5" alignment="CENTER">
                        <ToggleButton fx:id="filterAllBtn" text="Tous"
                                      styleClass="filter-chip" selected="true"/>
                        <ToggleButton fx:id="filterUserBtn" text="ðŸ‘¤ Utilisateur"
                                      styleClass="filter-chip"/>
                        <ToggleButton fx:id="filterMoodBtn" text="ðŸ˜Š Humeur"
                                      styleClass="filter-chip"/>
                        <ToggleButton fx:id="filterStressBtn" text="ðŸ˜° Stress"
                                      styleClass="filter-chip"/>
                        <ToggleButton fx:id="filterEnergyBtn" text="âš¡ Ã‰nergie"
                                      styleClass="filter-chip"/>
                    </HBox>

                    <!-- Statistiques -->
                    <Label fx:id="lblAvgMood" text="ðŸ˜Š Humeur moyenne: -"
                           style="-fx-text-fill: #3A7D6B; -fx-font-size: 14; -fx-background-color: rgba(255,255,255,0.5); -fx-padding: 5 10; -fx-background-radius: 20;"/>
                    <Label fx:id="lblAvgSleep" text="ðŸ˜´ Sommeil moyen: -"
                           style="-fx-text-fill: #3A7D6B; -fx-font-size: 14; -fx-background-color: rgba(255,255,255,0.5); -fx-padding: 5 10; -fx-background-radius: 20;"/>
                </HBox>

                <!-- Compteur -->
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label fx:id="lblCount" text="0 suivi(s)"
                           styleClass="subheader-label" style="-fx-font-size: 16; -fx-font-weight: bold;"/>
                    <Label text="entrÃ©es enregistrÃ©es" style="-fx-text-fill: #6F9A8D; -fx-font-size: 14;"/>
                </HBox>

                <!-- Cards Container -->
                <ScrollPane fitToWidth="true" prefHeight="550"
                            style="-fx-background-color: transparent; -fx-border-color: transparent;">
                    <content>
                        <FlowPane fx:id="cardsContainer"
                                  hgap="20" vgap="20"
                                  prefWrapLength="1000"
                                  styleClass="flow-pane"
                                  style="-fx-padding: 10;" />
                    </content>
                </ScrollPane>

            </VBox>
        </center>

        <!-- Footer -->
        <bottom>
            <HBox alignment="CENTER" style="-fx-padding: 20 0 10 0;">
                <VBox alignment="CENTER" spacing="5">
                    <Label text="ðŸŒ¿ Prenez soin de vous - Ã‰coutez votre corps ðŸ’š"
                           style="-fx-font-size: 14; -fx-text-fill: #3A7D6B;"/>
                    <Label text="(c) 2026 EVOLIA - Espace bien-Ãªtre"
                           style="-fx-font-size: 12; -fx-text-fill: #6F9A8D;"/>
                </VBox>
            </HBox>
        </bottom>

    </BorderPane>
</StackPane>