<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.effect.GaussianBlur?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="tn.esprit.controllers.UserDashboardController"
           prefWidth="1400" prefHeight="800"
           stylesheets="@styles.css">

    <!-- ðŸŒ¿ Background nature apaisant -->
    <ImageView fitWidth="1400" fitHeight="800" preserveRatio="false" styleClass="nature-background">
        <image>
            <Image url="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?w=1600&amp;q=80"
                   backgroundLoading="true"/>
        </image>
        <effect>
            <GaussianBlur radius="5"/>
        </effect>
    </ImageView>

    <!-- ðŸŒ¿ Overlay -->
    <Region styleClass="overlay"/>

    <!-- HBox principale avec Sidebar + Contenu -->
    <HBox spacing="0" alignment="CENTER">

        <!-- ================ NAVBAR LATÃ‰RALE GAUCHE - USER ================ -->
        <VBox styleClass="sidebar" alignment="TOP_CENTER" prefWidth="280">

            <!-- Logo et titre -->
            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 0 0 20 0;">
                <Label text="ðŸ’™" style="-fx-font-size: 52;" styleClass="sidebar-logo"/>
                <Label text="EVOLIA" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: white;"/>
                <Label text="Mon espace personnel"
                       style="-fx-font-size: 14; -fx-text-fill: #E0F2E0;
                              -fx-background-color: rgba(255,255,255,0.15);
                              -fx-padding: 6 18 6 18; -fx-background-radius: 25;"/>
            </VBox>

            <Separator style="-fx-background-color: rgba(255,255,255,0.2); -fx-pref-height: 1.5; -fx-pref-width: 220;"/>

            <!-- ================ MENU DE NAVIGATION AVEC SCROLL ================ -->
            <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED"
                        style="-fx-background-color: transparent; -fx-background: transparent;
                              -fx-border-width: 0; -fx-pref-width: 260; -fx-pref-height: 550;">

                <VBox spacing="12" style="-fx-padding: 15 5 15 0;" alignment="TOP_CENTER">

                    <!-- Tableau de bord -->
                    <Button fx:id="btnDashboard" text="ðŸ“Š Tableau de bord"
                            styleClass="sidebar-button" prefWidth="230"
                            style="-fx-border-color: white; -fx-border-width: 1.5; -fx-border-radius: 25; -fx-background-color: rgba(255,255,255,0.2);"
                            onAction="#handleDashboard"/>

                    <!-- Ã‰vÃ©nements -->
                    <Button fx:id="btnEvents" text="ðŸ“… Ã‰vÃ©nements"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleEvents"/>

                    <!-- Exercices -->
                    <Button fx:id="btnExercises" text="ðŸ§˜ Exercices"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleExercises"/>

                    <!-- Journal bien-Ãªtre -->
                    <Button fx:id="btnWellness" text="ðŸ“ Journal bien-Ãªtre"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleWellness"/>

                    <!-- Mes rendez-vous -->
                    <Button fx:id="btnAppointments" text="ðŸ“† Mes rendez-vous"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleAppointments"/>

                    <!-- Mon profil -->
                    <Button fx:id="btnProfile" text="ðŸ‘¤ Mon profil"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleProfile"/>

                    <Separator style="-fx-background-color: rgba(255,255,255,0.2); -fx-pref-height: 1; -fx-pref-width: 200; -fx-padding: 10 0;"/>

                    <!-- Notifications -->
                    <Button fx:id="btnNotifications" text="ðŸ”” Notifications"
                            styleClass="sidebar-button" prefWidth="230"
                            onAction="#handleNotifications"/>

                </VBox>
            </ScrollPane>

            <Region VBox.vgrow="ALWAYS"/>

            <!-- ================ FOOTER NAVBAR ================ -->
            <VBox alignment="CENTER" spacing="12" style="-fx-padding: 15 0 5 0;">
                <Separator style="-fx-background-color: rgba(255,255,255,0.2); -fx-pref-height: 1.5; -fx-pref-width: 220;"/>

                <!-- BOUTON DÃ‰CONNEXION -->
                <Button fx:id="btnLogout" text="ðŸšª DÃ©connexion"
                        styleClass="sidebar-button" prefWidth="230"
                        style="-fx-background-color: rgba(255,255,255,0.05);"
                        onAction="#handleLogout"/>

                <!-- Informations utilisateur dynamiques -->
                <VBox alignment="CENTER" spacing="3" style="-fx-padding: 5 0 0 0;">
                    <Label fx:id="userNameLabel" text="Utilisateur"
                           style="-fx-text-fill: white; -fx-font-size: 15; -fx-font-weight: bold;"/>
                    <Label fx:id="userEmailLabel" text="email@example.com"
                           style="-fx-text-fill: #E0F2E0; -fx-font-size: 12; -fx-font-style: italic;"/>
                </VBox>
            </VBox>
        </VBox>

        <!-- ================ CONTENU PRINCIPAL - DYNAMIQUE ================ -->
        <StackPane fx:id="contentArea" HBox.hgrow="ALWAYS"
                   style="-fx-background-color: transparent; -fx-padding: 0;"/>
    </HBox>
</StackPane>
