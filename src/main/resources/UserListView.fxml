<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.effect.GaussianBlur?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="tn.esprit.controllers.UserListController"
           prefWidth="1150" prefHeight="800"
           stylesheets="@styles.css">

    <!-- ðŸŒ¿ Background nature apaisant -->
    <ImageView fitWidth="1150" fitHeight="800" preserveRatio="false" styleClass="nature-background">
        <image>
            <Image url="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?w=1600&amp;q=80"
                   backgroundLoading="true"/>
        </image>
        <effect>
            <GaussianBlur radius="5"/>
        </effect>
    </ImageView>

    <!-- ðŸŒ¿ Overlay vert pistache trÃ¨s doux -->
    <Region styleClass="overlay"/>

    <!-- Contenu principal - MÃŠMES FONCTIONNALITÃ‰S, DESIGN NATURE -->
    <BorderPane style="-fx-background-color: transparent; -fx-padding: 20;">

        <!-- Header avec design nature -->
        <top>
            <VBox alignment="CENTER" spacing="10" style="-fx-padding: 20 0 20 0;">
                <HBox alignment="CENTER" spacing="15">
                    <Label text="ðŸ‘¥" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                    <Label text="Gestion des Utilisateurs" styleClass="header-label" style="-fx-font-size: 32;"/>
                    <Label text="ðŸŒ¿" style="-fx-font-size: 40; -fx-text-fill: #3A7D6B;"/>
                </HBox>
                <Label text="GÃ©rez votre communautÃ© avec bienveillance" styleClass="subheader-label"/>
            </VBox>
        </top>

        <!-- Center - MÃŠMES FONCTIONNALITÃ‰S -->
        <center>
            <VBox spacing="15" styleClass="card" style="-fx-padding: 20; -fx-background-color: rgba(255,255,255,0.7);"
                  VBox.vgrow="ALWAYS">

                <!-- Search and Filter Bar - IDENTIQUE -->
                <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 20 20 10 20;">
                    <TextField fx:id="searchField" promptText="Rechercher par nom ou email..."
                               prefWidth="300" styleClass="text-field"/>
                    <Button text="Rechercher" onAction="#handleSearch" styleClass="button-primary"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="+ Nouvel Utilisateur" onAction="#handleAddUser" styleClass="button-secondary"/>
                    <Button text="â†» Actualiser" onAction="#handleRefresh"
                            style="-fx-background-color: #95A5A6; -fx-text-fill: white; -fx-font-size: 14; -fx-background-radius: 25; -fx-cursor: hand; -fx-padding: 8 20;"/>
                </HBox>

                <!-- Table - IDENTIQUE -->
                <TableView fx:id="userTable" VBox.vgrow="ALWAYS"
                           style="-fx-font-size: 13; -fx-background-color: transparent; -fx-border-color: #D4E8D0; -fx-border-radius: 15; -fx-padding: 5;" prefHeight="450">

                    <columns>
                        <TableColumn fx:id="idColumn" text="ID" prefWidth="50"
                                     style="-fx-alignment: CENTER; -fx-background-color: #F0F9EC;"/>
                        <TableColumn fx:id="nomColumn" text="Nom" prefWidth="150"/>
                        <TableColumn fx:id="emailColumn" text="Email" prefWidth="200"/>
                        <TableColumn fx:id="roleColumn" text="RÃ´le" prefWidth="120"
                                     style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="telephoneColumn" text="TÃ©lÃ©phone" prefWidth="130"
                                     style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="actifColumn" text="Actif" prefWidth="80"
                                     style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="actionsColumn" text="Actions" prefWidth="200"
                                     style="-fx-alignment: CENTER;"/>
                    </columns>

                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                    </columnResizePolicy>
                </TableView>

                <!-- ðŸ“Š STATS BAR - SIMPLIFIÃ‰E (SANS COACH/CLIENT/PSYCHO) -->
                <HBox spacing="20" style="-fx-padding: 15 20; -fx-background-color: rgba(225,240,218,0.8); -fx-background-radius: 15; -fx-border-color: #B5D3A7; -fx-border-radius: 15; -fx-border-width: 1;"
                      alignment="CENTER_LEFT">

                    <!-- Total utilisateurs -->
                    <HBox spacing="10" alignment="CENTER">
                        <Label text="ðŸ“Š" style="-fx-font-size: 18; -fx-text-fill: #3A7D6B;"/>
                        <Label fx:id="totalUsersLabel" text="Total: 0 utilisateurs"
                               style="-fx-font-weight: bold; -fx-text-fill: #3A7D6B; -fx-font-size: 15;"/>
                    </HBox>

                    <Separator orientation="VERTICAL" style="-fx-background-color: #B5D3A7; -fx-pref-height: 30;"/>

                    <!-- Utilisateurs actifs -->
                    <HBox spacing="10" alignment="CENTER">
                        <Label text="âœ…" style="-fx-font-size: 16; -fx-text-fill: #2E7D32;"/>
                        <Label fx:id="activeUsersLabel" text="Actifs: 0"
                               style="-fx-text-fill: #2E7D32; -fx-font-weight: 600; -fx-font-size: 15;"/>
                    </HBox>

                    <Separator orientation="VERTICAL" style="-fx-background-color: #B5D3A7; -fx-pref-height: 30;"/>

                    <!-- Utilisateurs inactifs -->
                    <HBox spacing="10" alignment="CENTER">
                        <Label text="âŒ" style="-fx-font-size: 16; -fx-text-fill: #B85C5C;"/>
                        <Label fx:id="inactiveUsersLabel" text="Inactifs: 0"
                               style="-fx-text-fill: #B85C5C; -fx-font-weight: 600; -fx-font-size: 15;"/>
                    </HBox>

                    <Region HBox.hgrow="ALWAYS"/>

                    <!-- Message bienveillant -->
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="ðŸŒ¿" style="-fx-font-size: 16; -fx-text-fill: #5F9B8A;"/>
                        <Label text="CommunautÃ© bienveillante"
                               style="-fx-text-fill: #5F9B8A; -fx-font-style: italic; -fx-font-size: 14;"/>
                    </HBox>
                </HBox>

                <!-- Espace pour d'autres composants si nÃ©cessaire -->
                <Region VBox.vgrow="ALWAYS" minHeight="10"/>

            </VBox>
        </center>

        <!-- Footer design nature -->
        <bottom>
            <HBox alignment="CENTER" style="-fx-padding: 20 0 10 0;">
                <VBox alignment="CENTER" spacing="5">
                    <Label text="ðŸŒ¿  Bienveillance â€¢ Respect â€¢ Accompagnement  ðŸ’™"
                           style="-fx-font-size: 14; -fx-text-fill: #3A7D6B;"/>
                    <Label text="Â© 2026 PsyCoach Pro - Gestion des utilisateurs"
                           style="-fx-font-size: 12; -fx-text-fill: #6F9A8D;"/>
                </VBox>
            </HBox>
        </bottom>

    </BorderPane>
</StackPane>